<html lang="en">
<head>
    <!-- ============================================
         CSS & DESIGN LINKS
         ============================================ -->
    <title>Leaflet OSRM Example</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    
    <!-- Google Fonts - Inter font family for consistent typography -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;150;200;300;400;500;600;700&display=swap"
        rel="stylesheet">
    
    <!-- Font Awesome icons for UI elements -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
        integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    <!-- Custom application styles -->
    <link rel="stylesheet" href="style.css">

    <!-- ============================================
         GRAPHHOPPER & LEAFLET ROUTING MACHINE LINKS
         ============================================ -->
    <!-- Leaflet CSS for map functionality -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css" />
    
    <!-- Leaflet Routing Machine CSS for routing controls -->
    <link rel="stylesheet" href="GraphHopper\leaflet-routing-machine-3.2.12\dist\leaflet-routing-machine.css" />
    
    <!-- Leaflet Control Geocoder CSS for address search -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />

</head>
<body>
    <!-- ============================================
         HEADER SECTION
         Contains the main navigation and branding
         ============================================ -->
    <header class="header">
        <div class="top-bar">
            <div class="top-bar_content">
                <!-- Application branding/logo -->
                <a href="#" class="title">
                    <span>ClearRoute</span>
                </a>

                <!-- User account access button -->
                <a href="#" class="usericon">
                    <label for="account-toggle">
                        <img src="circle-user-regular.svg" alt="userlogo" class="userlogo_img">
                    </label>
                </a>
            </div>
        </div>
    </header>

    <div class="container">
        <!-- ============================================
             POPUP CONTROL SYSTEM
             Hidden checkboxes that control popup visibility
             Uses CSS :checked selector for state management
             ============================================ -->
        <input type="checkbox" id="save-route-toggle" class="popup-toggle">
        <input type="checkbox" id="history-route-toggle" class="popup-toggle">
        <input type="checkbox" id="vehicles-toggle" class="popup-toggle">
        <input type="checkbox" id="account-toggle" class="popup-toggle">
        <input type="checkbox" id="login-register-toggle" class="popup-toggle">
        <input type="checkbox" id="user-logged-in" class="user-state-toggle">
        <input type="checkbox" id="add-vehicle-toggle" class="popup-toggle">
        <input type="checkbox" id="edit-vehicle-toggle" class="popup-toggle">
        <input type="checkbox" id="delete-vehicle-toggle" class="popup-toggle">

        <!-- ============================================
             MAP CONTAINER
             Main interactive map area for routing
             ============================================ -->
        <div id="map"></div>

        <!-- ============================================
             ROUTE SEARCH PANEL
             Fixed position panel for vehicle parameters and routing
             ============================================ -->

        <div class="RouteSearch">
            <form id="form" action="/">
                <!-- Panel title -->
                <div class="entity">
                    <h1>Route Search</h1>
                </div>

                <!-- Vehicle dimension inputs for routing constraints -->
                <div class="inputs">
                    <label for="height">Height</label>
                    <input id="height" name="heightIn" type="text" size="20">
                    <label for="weight">Weight</label>
                    <input id="weight" name="weightIn" type="text" size="20">
                    <label for="width">Width</label>
                    <input id="width" name="widthIn" type="text" size="20">
                </div>

                <!-- Saved routes dropdown selection -->
                <!-- <div class="inputs">
                    <label for="vehicle">Saved Routes</label>
                    <select>
                        <option value="route">Home to Downtown Office</option>
                        <option value="route">route2</option>
                        <option value="route">route3</option>
                    </select>
                </div> -->

                <!-- Action buttons for routing and popup management -->
                <div class="popup-buttons">
                    <input type="submit" id="submit" value="Reroute">
                    <label for="save-route-toggle" class="popup-btn">Save Route</label>
                    <label for="vehicles-toggle" class="popup-btn">Manage Vehicles</label>
                </div>

                <div class="popup-buttons">
                    <label class="popup-btn" onclick="saveLocation()">Save Location</label>
                    <label for="history-route-toggle" class="popup-btn">View Route History</label>
                </div>
            </form>
        </div>

        <!-- ============================================
             SAVE ROUTE POPUP
             Modal form for saving route with name
             ============================================ -->
        <div class="popup-overlay" id="save-route-popup">
            <label for="save-route-toggle" class="popup-background"></label>
            <div class="popup-content">
                <div class="popup-header">
                    <h2>Save Route</h2>
                    <label for="save-route-toggle" class="close-btn">&times;</label>
                </div>

                <div class="popup-body">
                    <form id="save-route-form">
                        <div class="inputs">
                            <label for="route-name">Route Name</label>
                            <input id="route-name" name="routeName" type="text" placeholder="Enter route name" required>
                        </div>
                    </form>
                </div>

                <div class="popup-footer">
                    <button type="button" class="cancel-btn" onclick="document.getElementById('save-route-toggle').checked = false;">Cancel</button>
                    <button type="submit" form="save-route-form" class="save-vehicle-btn">Save Route</button>
                </div>
            </div>
        </div>
        
        <!-- ============================================
             SAVED ROUTES POPUP
             Modal for viewing, using, and managing saved routes
             ============================================ -->
        <div class="popup-overlay" id="history-route-popup">
            <!-- Background overlay - clicking closes popup -->
            <label for="history-route-toggle" class="popup-background"></label>

            <div class="popup-content">
                <!-- Popup header with title and close button -->
                <div class="popup-header">
                    <h2>Saved Routes</h2>
                    <label for="history-route-toggle" class="close-btn">&times;</label>
                </div>

                <div class="popup-body" id="history-route-list">
                    <!-- <div class="route-item" data-route-id="0">
                        <h3>Home to Work</h3>
                        <p>Distance: 15.2 km | Time: 22 min</p>
                        <div class="route-actions">
                            <button class="use-route-btn">Use Route</button>
                            <button class="delete-route-btn">Delete</button>
                        </div>
                    </div> -->
                </div>
                
                <!-- Footer with save current route action -->
                <div class="popup-footer">
                    <button class="add-new-btn">Save Current Route</button>
                </div>
            </div>
        </div>

        <!-- ============================================
             VEHICLE MANAGEMENT POPUP
             Modal for viewing, selecting, and managing vehicles
             ============================================ -->
        <div class="popup-overlay" id="vehicles-popup">
            <!-- Background overlay - clicking closes popup -->
            <label for="vehicles-toggle" class="popup-background"></label>
            <div class="popup-content">
                <!-- Popup header with title and close button -->
                <div class="popup-header">
                    <h2>Vehicle Management</h2>
                    <label for="vehicles-toggle" class="close-btn">&times;</label>
                </div>

                <div class="popup-body" id="vehicle-list"></div>

                <div class="popup-footer">
                    <button class="add-new-btn" onclick="document.getElementById('add-vehicle-toggle').checked = true;">Add New Vehicle</button>
                </div>
            </div>
        </div>

        <!-- ============================================
             ADD NEW VEHICLE POPUP
             Modal form for creating new vehicles
             ============================================ -->
        <div class="popup-overlay" id="add-vehicle-popup">
            <label for="add-vehicle-toggle" class="popup-background"></label>
            <div class="popup-content">
                <div class="popup-header">
                    <h2>Add New Vehicle</h2>
                    <label for="add-vehicle-toggle" class="close-btn">&times;</label>
                </div>

                <div class="popup-body">
                    <form id="add-vehicle-form">
                        <div class="inputs">
                            <label for="vehicle-name">Vehicle Name</label>
                            <input id="vehicle-name" name="vehicleName" type="text" placeholder="Enter vehicle name" required>
                        </div>

                        <div class="inputs">
                            <label for="vehicle-height">Height (meters)</label>
                            <input id="vehicle-height" name="vehicleHeight" type="number" step="0.1" min="0" placeholder="e.g., 4.1" required>
                        </div>

                        <div class="inputs">
                            <label for="vehicle-weight">Weight (tons)</label>
                            <input id="vehicle-weight" name="vehicleWeight" type="number" step="0.1" min="0" placeholder="e.g., 40" required>
                        </div>

                        <div class="inputs">
                            <label for="vehicle-width">Width (meters)</label>
                            <input id="vehicle-width" name="vehicleWidth" type="number" step="0.1" min="0" placeholder="e.g., 2.6" required>
                        </div>
                    </form>
                </div>

                <div class="popup-footer">
                    <button type="button" class="cancel-btn" onclick="document.getElementById('add-vehicle-toggle').checked = false;">Cancel</button>
                    <button type="submit" form="add-vehicle-form" class="save-vehicle-btn">Save Vehicle</button>
                </div>
            </div>
        </div>

        <!-- ============================================
             EDIT VEHICLE POPUP
             Modal form for editing existing vehicles
             ============================================ -->
        <div class="popup-overlay" id="edit-vehicle-popup">
            <!-- Background overlay - clicking closes popup -->
            <label for="edit-vehicle-toggle" class="popup-background"></label>
            <div class="popup-content">
                <!-- Popup header with title and close button -->
                <div class="popup-header">
                    <h2>Edit Vehicle</h2>
                    <label for="edit-vehicle-toggle" class="close-btn">&times;</label>
                </div>

                <!-- Form for editing vehicle specifications -->
                <div class="popup-body">
                    <form id="edit-vehicle-form">
                        <div class="inputs">
                            <label for="edit-vehicle-name">Vehicle Name</label>
                            <input id="edit-vehicle-name" name="editVehicleName" type="text" placeholder="Enter vehicle name" required>
                        </div>

                        <div class="inputs">
                            <label for="edit-vehicle-height">Height (meters)</label>
                            <input id="edit-vehicle-height" name="editVehicleHeight" type="number" step="0.1" min="0" placeholder="e.g., 4.1" required>
                        </div>

                        <div class="inputs">
                            <label for="edit-vehicle-weight">Weight (tons)</label>
                            <input id="edit-vehicle-weight" name="editVehicleWeight" type="number" step="0.1" min="0" placeholder="e.g., 40" required>
                        </div>

                        <div class="inputs">
                            <label for="edit-vehicle-width">Width (meters)</label>
                            <input id="edit-vehicle-width" name="editVehicleWidth" type="number" step="0.1" min="0" placeholder="e.g., 2.6" required>
                        </div>
                    </form>
                </div>

                <!-- Form action buttons -->
                <div class="popup-footer">
                    <button type="button" class="cancel-btn" onclick="document.getElementById('edit-vehicle-toggle').checked = false;">Cancel</button>
                    <button type="submit" form="edit-vehicle-form" class="save-vehicle-btn">Update Vehicle</button>
                </div>
            </div>
        </div>

        <!-- ============================================
             DELETE CONFIRMATION POPUP
             Generic confirmation modal for delete operations
             Used for both vehicles and routes
             ============================================ -->
        <div class="popup-overlay" id="delete-vehicle-popup">
            <!-- Background overlay - clicking closes popup -->
            <label for="delete-vehicle-toggle" class="popup-background"></label>
            <div class="popup-content delete-confirmation">
                <!-- Dynamic popup header (changes based on delete type) -->
                <div class="popup-header">
                    <h2 id="delete-popup-title">Delete Vehicle</h2>
                    <label for="delete-vehicle-toggle" class="close-btn">&times;</label>
                </div>

                <!-- Confirmation message and item details -->
                <div class="popup-body">
                    <div class="delete-message">
                        <!-- Dynamic confirmation message -->
                        <p id="delete-confirmation-message">Are you sure you want to delete this vehicle?</p>
                        
                        <!-- Item information display -->
                        <div class="vehicle-info">
                            <h3 id="delete-vehicle-name">Vehicle Name</h3>
                            <p id="delete-vehicle-details">Height: 0m | Weight: 0t | Width: 0m</p>
                        </div>
                        
                        <!-- Warning message -->
                        <p class="warning-text">This action cannot be undone.</p>
                    </div>
                </div>

                <!-- Confirmation action buttons -->
                <div class="popup-footer">
                    <button type="button" class="cancel-btn" onclick="document.getElementById('delete-vehicle-toggle').checked = false;">Cancel</button>
                    <button type="button" id="confirm-delete-btn" class="delete-btn">Delete</button>
                </div>
            </div>
        </div>

        <!-- ============================================
             ACCOUNT POPUP SYSTEM
             Dual-mode popup for login/register and user account
             Switches between modes based on login state
             ============================================ -->
        <div class="popup-overlay" id="account-popup">
            <label for="account-toggle" class="popup-background"></label>
            
            <!-- Login/Register Form (shown when not logged in) -->
            <div class="popup-content login-register-content">
                <div class="popup-header">
                    <h2 class="auth-title">Welcome to ClearRoute</h2>
                    <label for="account-toggle" class="close-btn">&times;</label>
                </div>
                
                <div class="auth-container">
                    <!-- Login Form -->
                    <div class="auth-form login-form">
                        <h3>Login</h3>

                        <div class="auth-inputs">
                            <div class="inputs">
                                <label for="login-email">Email</label>
                                <input id="login-email" type="email" placeholder="Enter your email">
                            </div>

                            <div class="inputs">
                                <label for="login-password">Password</label>
                                <input id="login-password" type="password" placeholder="Enter your password">
                            </div>

                        </div>
                        <label class="btn auth-btn" onclick="LoginAccount()">Login</label>
                        <p class="auth-switch">Don't have an account? <label for="login-register-toggle" class="switch-link">Register here</label></p>
                    </div>
                    
                    <!-- Register Form -->
                    <div class="auth-form register-form">
                        <h3>Create Account</h3>
                        <div class="auth-inputs">

                            <div class="inputs">
                                <label for="registerName">Full Name</label>
                                <input id="registerName" type="text" placeholder="Enter your full name">
                                <span id="nameError" style="color:red;"></span>
                            </div>
                        
                            <div class="inputs">
                                <label for="registerEmail">Email</label>
                                <input id="registerEmail" type="email" placeholder="Enter your email">
                                <span id="emailError" style="color:red;"></span>
                            </div>

                            <div class="inputs">
                                <label for="registerPassword">Password</label>
                                <input id="registerPassword" type="password" placeholder="Create a password">
                                <span id="passwordError" style="color:red;"></span>
                            </div>

                            <div class="inputs">
                                <label for="registerConfirm">Confirm Password</label>
                                <input id="registerConfirm" type="password" placeholder="Confirm your password">
                                <span id="confirmPassError" style="color:red;"></span>
                            </div>

                        </div>
                        <label class="btn auth-btn" onclick="CreateAccount()">Create Account</label>
                        <p class="auth-switch">Already have an account? <label for="login-register-toggle" class="switch-link">Login here</label></p>
                    </div>
                </div>
            </div>
            
            <!-- User Account Page (shown when logged in) -->
            <div class="popup-content user-account-content">
                <div class="popup-header">
                    <h2>My Account</h2>
                    <label for="account-toggle" class="close-btn">&times;</label>
                </div>
                <div class="popup-body">

                    <div class="user-info">
                        <div class="user-avatar">
                            <img src="circle-user-solid.svg" alt="User Avatar" class="avatar-img">
                        </div>

                        <div class="user-details">
                            <h3 id="user-info-name">John Doe</h3>
                            <p id="user-info-email">john.doe@email.com</p>
                            <p >Member since: August 2025</p>
                        </div>
                    </div>
                    
                    <div class="account-section">
                        <h4>Account Settings</h4>
                        <div class="settings-actions">
                            <button class="settings-btn">Edit Profile</button>
                            <button class="settings-btn">Change Password</button>
                        </div>
                    </div>

                </div>
                <div class="popup-footer">
                    <label class="logout-btn" onclick="LogOut()">Logout</label>
                </div>
            </div>

    </div>

    <!-- ============================================
         JAVASCRIPT LIBRARIES AND APPLICATION SCRIPTS
         ============================================ -->
    
    <!-- Leaflet JavaScript library for interactive maps -->
    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"></script>
    
    <!-- Leaflet Routing Machine for route calculation and display -->
    <script src="GraphHopper/leaflet-routing-machine-3.2.12/dist/leaflet-routing-machine.js"></script>
    
    <!-- GraphHopper integration for LRM -->
    <script src="GraphHopper\leaflet-routing-machine-3.2.12\lrm-graphhopper-1.2.0.js"></script>
    <script src="GraphHopper\leaflet-routing-machine-3.2.12\Polyline.encoded.js"></script>
    
    <!-- Geocoding control for address search functionality -->
    <script src="GraphHopper/leaflet-routing-machine-3.2.12/examples/Control.Geocoder.js"></script>
    
    <!-- GraphHopper configuration settings -->
    <script src="GraphHopper/leaflet-routing-machine-3.2.12/examples/config.js"></script>
    
    <!-- Polyline encoding/decoding utilities -->
    <script src="https://unpkg.com/@mapbox/polyline@1.1.1/src/polyline.js"></script>
    
    <!-- Main application logic and routing functionality -->
    <script src="database.js"></script> 
    <script src="routing.js"></script> 
    
    <!-- Additional polyline utilities -->
    <script src="GraphHopper\leaflet-routing-machine-3.2.12\Polyline.encoded.js"></script>

    <!-- Commented out scripts - kept for reference -->
    <!-- <script src="GraphHopper/leaflet-routing-machine-3.2.12/examples/DemoRouting.js"></script> -->
    <!-- <script src="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.js"></script> -->
    <!-- <script src="Control.Geocoder.js"></script>
    <script src="config.js"></script>
    <script src="index.js"></script> -->
    
</body>
</html>